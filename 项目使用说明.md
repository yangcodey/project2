# 侬帮我养在线销售预约系统 - 使用说明

## 项目概述

本项目是基于 Spring Boot + Vue.js 构建的"侬帮我养"在线销售预约系统，实现了从养殖到销售的一体化管理。

### 技术栈

**后端：**
- Spring Boot 3.5.5
- MyBatis 3.0.5
- MySQL 8.0.33
- JWT认证
- Redis缓存（可选）

**前端：**
- Vue.js 3.5.18
- Element Plus 2.11.2
- Vite 7.1.2
- Axios 1.7.7
- ECharts 5.5.1

## 数据库配置

### 数据库信息
- 数据库账号：`root`
- 数据库密码：`1234`
- 数据库名称：`nongbangwoyang`

### 数据库初始化

**方式一：使用完整初始化脚本（推荐）**
```bash
mysql -u root -p1234 < 完整数据库初始化.sql
```

**方式二：分步初始化**
1. 先执行基础表创建：
```bash
mysql -u root -p1234 < 配置.sql
```

2. 再执行补充表创建：
```bash
mysql -u root -p1234 < 补充数据库表.sql
```

### 数据库表结构

系统包含以下数据库表：

#### 1. 基础功能表
- `users` - 用户表（管理员、销售方、购买方）
- `products` - 产品表
- `orders` - 订单表

#### 2. 养殖管理功能表
- `breeding_plans` - 养殖计划表

#### 3. 物流配送功能表
- `logistics` - 物流配送表

#### 4. 商城功能表
- `product_categories` - 产品分类表
- `product_suppliers` - 产品供应商关系表
- `seller_inventory` - 销售方库存表
- `marketplace_products` - 商城产品表
- `seller_purchase_orders` - 销售方采购订单表
- `seller_reviews` - 销售方评价表

#### 5. 个人中心功能表
- `user_addresses` - 用户地址表
- `user_favorites` - 用户收藏表
- `browse_history` - 浏览历史表

#### 6. 通知系统表
- `notifications` - 通知表

#### 7. 评价系统表
- `reviews` - 产品评价表

## 后端项目启动

### 1. 配置文件

配置文件位于：`src/main/resources/application.properties`

主要配置项已设置好：
```properties
# 应用配置
spring.application.name=nongbangwoyang
server.port=8080

# 数据库配置
spring.datasource.url=jdbc:mysql://localhost:3306/nongbangwoyang?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
spring.datasource.username=root
spring.datasource.password=1234

# JWT配置
jwt.secret=nongbangwoyang_secret_key_2024
jwt.expiration=86400000
```

### 2. 启动项目

使用Maven启动：
```bash
mvn spring-boot:run
```

或使用IDE直接运行主类：
```
com.example.project2.Project2Application
```

### 3. 访问地址

后端API地址：`http://localhost:8080`

## 前端项目启动

### 1. 安装依赖

进入前端目录：
```bash
cd vite-project
pnpm install
```

### 2. 启动开发服务器

```bash
pnpm dev
```

### 3. 访问地址

前端访问地址：`http://localhost:5173`

## 核心功能模块

### 1. 用户管理模块

**API接口：** `/api/users`

**功能：**
- 用户注册
- 用户登录（JWT认证）
- 用户信息查询
- 用户信息修改
- 用户状态管理
- 角色权限管理（管理员、销售方、购买方）

**测试账号：**
- 管理员：`admin` / `1234`
- 销售方1：`seller1` / `1234`
- 销售方2：`seller2` / `1234`
- 购买方1：`buyer1` / `1234`
- 购买方2：`buyer2` / `1234`

### 2. 养殖产品管理模块

**API接口：** `/api/products`

**功能：**
- 产品信息添加、修改、删除
- 产品信息查询（按名称、品种、价格区间）
- 产品库存管理（自动更新）
- 产品上下架管理
- 产品分页查询
- 支持批量导入导出

### 3. 预约订单管理模块

**API接口：** `/api/orders`

**功能：**
- 订单创建（自动生成订单号）
- 订单支付
- 订单状态管理（待支付、已支付、已发货、已完成、已取消）
- 订单查询（按订单号、购买方、状态等）
- 订单取消（自动恢复库存）
- 库存自动更新

**订单状态流程：**
```
待支付 → 已支付 → 已发货 → 已送达 → 已完成
   ↓
 已取消
```

### 4. 养殖计划管理模块

**API接口：** `/api/breeding-plans`

**功能：**
- 养殖计划添加、修改、删除
- 计划状态管理（计划中、进行中、已完成、已取消）
- 计划查询（按产品、负责人、状态）
- 自动生成计划编号
- 计划统计分析

**计划状态流程：**
```
计划中 → 进行中 → 已完成
   ↓
 已取消
```

### 5. 物流配送管理模块

**API接口：** `/api/logistics`

**功能：**
- 物流信息录入
- 物流状态跟踪（已发货、运输中、已到达、已送达）
- 物流单号查询
- 当前位置更新
- 自动生成物流编号
- 物流公司统计

**物流状态流程：**
```
已发货 → 运输中 → 已到达 → 已送达
```

### 6. 数据分析模块

**API接口：** `/api/statistics`

**功能：**
- 系统概览统计
- 销售数据分析
- 用户分析（注册趋势、购买统计）
- 产品分析（品种分布、价格分布、库存统计）
- 订单分析（订单趋势、金额统计）
- 养殖计划分析
- 物流分析

## API接口文档

### 用户管理

| 接口 | 方法 | 说明 |
|------|------|------|
| `/api/users/register` | POST | 用户注册 |
| `/api/users/login` | POST | 用户登录 |
| `/api/users/{id}` | GET | 获取用户信息 |
| `/api/users` | GET | 获取所有用户 |
| `/api/users/{id}` | PUT | 更新用户信息 |
| `/api/users/{id}/status` | PUT | 更新用户状态 |
| `/api/users/{id}` | DELETE | 删除用户 |

### 产品管理

| 接口 | 方法 | 说明 |
|------|------|------|
| `/api/products` | GET | 获取所有产品 |
| `/api/products/{id}` | GET | 获取产品详情 |
| `/api/products` | POST | 添加产品 |
| `/api/products/{id}` | PUT | 更新产品 |
| `/api/products/{id}` | DELETE | 删除产品 |
| `/api/products/search?name=xxx` | GET | 搜索产品 |
| `/api/products/seller/{sellerId}` | GET | 获取销售方产品 |

### 订单管理

| 接口 | 方法 | 说明 |
|------|------|------|
| `/api/orders` | GET | 获取所有订单 |
| `/api/orders/{id}` | GET | 获取订单详情 |
| `/api/orders` | POST | 创建订单 |
| `/api/orders/{id}/pay` | POST | 支付订单 |
| `/api/orders/{id}/cancel` | POST | 取消订单 |
| `/api/orders/buyer/{buyerId}` | GET | 获取购买方订单 |
| `/api/orders/status/{status}` | GET | 按状态查询订单 |

### 养殖计划管理

| 接口 | 方法 | 说明 |
|------|------|------|
| `/api/breeding-plans` | GET | 获取所有养殖计划 |
| `/api/breeding-plans/{id}` | GET | 获取计划详情 |
| `/api/breeding-plans` | POST | 添加养殖计划 |
| `/api/breeding-plans/{id}` | PUT | 更新养殖计划 |
| `/api/breeding-plans/{id}/start` | POST | 开始执行计划 |
| `/api/breeding-plans/{id}/complete` | POST | 完成计划 |
| `/api/breeding-plans/{id}/cancel` | POST | 取消计划 |

### 物流管理

| 接口 | 方法 | 说明 |
|------|------|------|
| `/api/logistics` | GET | 获取所有物流信息 |
| `/api/logistics/{id}` | GET | 获取物流详情 |
| `/api/logistics` | POST | 添加物流信息 |
| `/api/logistics/ship` | POST | 订单发货 |
| `/api/logistics/{id}/transit` | POST | 标记为运输中 |
| `/api/logistics/{id}/arrived` | POST | 标记为已到达 |
| `/api/logistics/{id}/delivered` | POST | 标记为已送达 |
| `/api/logistics/tracking/{trackingNo}` | GET | 物流跟踪查询 |

### 数据统计

| 接口 | 方法 | 说明 |
|------|------|------|
| `/api/statistics/overview` | GET | 系统概览统计 |
| `/api/statistics/sales` | GET | 销售数据统计 |
| `/api/statistics/users` | GET | 用户分析数据 |
| `/api/statistics/products` | GET | 产品分析数据 |
| `/api/statistics/orders` | GET | 订单分析数据 |
| `/api/statistics/breeding-plans` | GET | 养殖计划分析 |
| `/api/statistics/logistics` | GET | 物流分析数据 |

## 项目特色功能

### 1. 自动库存管理
- 订单创建时自动扣减库存
- 订单取消时自动恢复库存
- 库存不足时自动提示

### 2. 自动编号生成
- 订单号自动生成（格式：NBWY+时间戳+随机码）
- 养殖计划编号自动生成（格式：BP+日期+随机码）
- 物流编号自动生成（格式：LG+日期+随机码）

### 3. 完整的状态流转
- 订单状态完整流转（待支付→已支付→已发货→已完成）
- 养殖计划状态管理（计划中→进行中→已完成）
- 物流状态跟踪（已发货→运输中→已到达→已送达）

### 4. 数据分析与统计
- 销售趋势分析
- 用户购买统计
- 产品销量排行
- 库存预警
- 多维度数据展示

## 项目文件说明

### 后端关键文件

```
src/main/java/com/example/project2/
├── controller/          # 控制器层
│   ├── UserController.java           # 用户管理
│   ├── ProductController.java        # 产品管理
│   ├── OrderController.java          # 订单管理
│   ├── BreedingPlanController.java   # 养殖计划管理
│   ├── LogisticsController.java      # 物流管理
│   └── StatisticsController.java     # 数据统计
├── service/            # 业务逻辑层
│   ├── UserService.java
│   ├── ProductService.java
│   ├── OrderService.java
│   ├── BreedingPlanService.java
│   └── LogisticsService.java
├── mapper/             # 数据访问层
├── entity/             # 实体类
└── util/               # 工具类
    └── JwtUtil.java    # JWT工具

src/main/resources/
├── application.properties  # 应用配置
└── mapper/                 # MyBatis映射文件
```

### 前端关键文件

```
vite-project/
├── src/
│   ├── api/           # API接口
│   ├── components/    # 组件
│   ├── router/        # 路由配置
│   └── views/         # 页面视图
├── package.json       # 依赖配置
└── vite.config.js     # Vite配置
```

## 常见问题

### 1. 数据库连接失败
- 检查MySQL服务是否启动
- 确认数据库账号密码是否正确（root/1234）
- 确认数据库名称是否为`nongbangwoyang`

### 2. 前端无法访问后端API
- 检查后端服务是否启动（端口8080）
- 检查CORS配置是否正确
- 查看浏览器控制台错误信息

### 3. Redis连接失败
- Redis配置是可选的，如果没有安装Redis，可以注释掉Redis相关配置
- 或者安装Redis服务并启动

## 开发建议

### 1. 安全性建议
- 生产环境应使用加密密码（BCrypt）
- JWT密钥应使用更复杂的字符串
- 启用Spring Security进行完整的安全控制

### 2. 性能优化建议
- 启用Redis缓存热点数据
- 添加分页查询限制
- 优化数据库索引
- 使用连接池管理数据库连接

### 3. 扩展功能建议
- 支付接口对接（支付宝、微信支付）
- 短信通知功能
- 邮件通知功能
- 文件上传功能（产品图片）
- 数据导出功能（Excel）

## 项目完成度

✅ 用户管理模块（100%）
✅ 产品管理模块（100%）
✅ 订单管理模块（100%）
✅ 养殖计划管理模块（100%）
✅ 物流配送管理模块（100%）
✅ 数据分析模块（100%）
✅ 数据库表结构（100%）
✅ API接口（100%）

## 联系方式

如有问题，请查看项目文档或联系开发团队。

---
**版本：** 1.0.0  
**最后更新：** 2024年

